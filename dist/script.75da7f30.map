{"version":3,"sources":["script.js"],"names":["$","$tab","$section","mvNum","isLoading","on","index","addClass","siblings","removeClass","eq","requestData","ajax","url","type","dataType","data","start","count","done","console","log","setData","fail","err","always","height","scrollTop","subjects","forEach","ele","template","$node","find","attr","images","small","text","title","rating","average","collect_count","year","genres","join","director","directors","j","push","name","casting","casts","m","append"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAAA,CAAC,CAAC,YAAW;AACX,MAAIC,IAAI,GAAGD,CAAC,CAAC,kBAAD,CAAZ;AACA,MAAIE,QAAQ,GAAGF,CAAC,CAAC,gBAAD,CAAhB;AACA,MAAIG,KAAK,GAAG,CAAZ;AACA,MAAIC,SAAS,GAAG,KAAhB;AAEAH,EAAAA,IAAI,CAACI,EAAL,CAAQ,OAAR,EAAiB,YAAW;AAC1B,QAAIC,KAAK,GAAGN,CAAC,CAAC,IAAD,CAAD,CAAQM,KAAR,EAAZ;AACAN,IAAAA,CAAC,CAAC,IAAD,CAAD,CAAQO,QAAR,CAAiB,OAAjB,EAA0BC,QAA1B,GAAqCC,WAArC,CAAiD,OAAjD;AACAP,IAAAA,QAAQ,CAACQ,EAAT,CAAYJ,KAAZ,EAAmBC,QAAnB,CAA4B,OAA5B,EAAqCC,QAArC,GAAgDC,WAAhD,CAA4D,OAA5D;AACD,GAJD;AAMAE,EAAAA,WAAW;;AACX,WAASA,WAAT,GAAuB;AACrB,QAAIP,SAAJ,EAAe,OADM,CAErB;;AACAA,IAAAA,SAAS,GAAG,IAAZ;AACAJ,IAAAA,CAAC,CAACY,IAAF,CAAO;AACLC,MAAAA,GAAG,EAAE,wCADA;AAELC,MAAAA,IAAI,EAAE,KAFD;AAGLC,MAAAA,QAAQ,EAAE,OAHL;AAILC,MAAAA,IAAI,EAAE;AACJC,QAAAA,KAAK,EAAEd,KADH;AAEJe,QAAAA,KAAK,EAAE;AAFH;AAJD,KAAP,EAQGC,IARH,CAQQ,UAASH,IAAT,EAAe;AACrBI,MAAAA,OAAO,CAACC,GAAR,CAAYL,IAAZ;AACAM,MAAAA,OAAO,CAACN,IAAD,CAAP;AACD,KAXD,EAWGO,IAXH,CAWQ,YAAW;AACjBH,MAAAA,OAAO,CAACC,GAAR,CAAY,SAASG,GAArB;AACD,KAbD,EAaGC,MAbH,CAaU,YAAW;AACnB;AACArB,MAAAA,SAAS,GAAG,KAAZ;AACD,KAhBD;AAiBD;;AAEDJ,EAAAA,CAAC,CAAC,MAAD,CAAD,CAAUK,EAAV,CAAa,QAAb,EAAuB,YAAW;AAChC,QAAGL,CAAC,CAAC,SAAD,CAAD,CAAaU,EAAb,CAAgB,CAAhB,EAAmBgB,MAAnB,KAA8B,EAA9B,IAAoC1B,CAAC,CAAC,MAAD,CAAD,CAAU2B,SAAV,KAAwB3B,CAAC,CAAC,MAAD,CAAD,CAAU0B,MAAV,EAA/D,EAAmF;AACjFf,MAAAA,WAAW;AACZ;AACF,GAJD,EApCW,CA0CX;;AACA,WAASW,OAAT,CAAiBN,IAAjB,EAAuB;AACrBb,IAAAA,KAAK,IAAI,EAAT;AACAa,IAAAA,IAAI,CAACY,QAAL,CAAcC,OAAd,CAAsB,UAAAC,GAAG,EAAI;AAC3B,UAAIC,QAAQ,+qBAAZ;AAsBF,UAAIC,KAAK,GAAGhC,CAAC,CAAC+B,QAAD,CAAb;AACAC,MAAAA,KAAK,CAACC,IAAN,CAAW,YAAX,EAAyBC,IAAzB,CAA8B,KAA9B,EAAqCJ,GAAG,CAACK,MAAJ,CAAWC,KAAhD;AACAJ,MAAAA,KAAK,CAACC,IAAN,CAAW,YAAX,EAAyBI,IAAzB,CAA8BP,GAAG,CAACQ,KAAlC;AACAN,MAAAA,KAAK,CAACC,IAAN,CAAW,eAAX,EAA4BI,IAA5B,CAAiCP,GAAG,CAACS,MAAJ,CAAWC,OAA5C;AACAR,MAAAA,KAAK,CAACC,IAAN,CAAW,iBAAX,EAA8BI,IAA9B,CAAmCP,GAAG,CAACW,aAAvC;AACAT,MAAAA,KAAK,CAACC,IAAN,CAAW,cAAX,EAA2BI,IAA3B,CAAgCP,GAAG,CAACY,IAApC;AACAV,MAAAA,KAAK,CAACC,IAAN,CAAW,gBAAX,EAA6BI,IAA7B,CAAkCP,GAAG,CAACa,MAAJ,CAAWC,IAAX,CAAgB,KAAhB,CAAlC;AAEAZ,MAAAA,KAAK,CAACC,IAAN,CAAW,kBAAX,EAA+BI,IAA/B,CAAoC,YAAW;AAC7C,YAAIQ,QAAQ,GAAG,EAAf;AACAf,QAAAA,GAAG,CAACgB,SAAJ,CAAcjB,OAAd,CAAsB,UAACkB,CAAD,EAAK;AACzBF,UAAAA,QAAQ,CAACG,IAAT,CAAcD,CAAC,CAACE,IAAhB;AACD,SAFD;AAGA,eAAOJ,QAAQ,CAACD,IAAT,CAAc,GAAd,CAAP;AACD,OAND;AAOAZ,MAAAA,KAAK,CAACC,IAAN,CAAW,iBAAX,EAA8BI,IAA9B,CAAmC,YAAW;AAC5C,YAAIa,OAAO,GAAG,EAAd;AACApB,QAAAA,GAAG,CAACqB,KAAJ,CAAUtB,OAAV,CAAkB,UAACuB,CAAD,EAAK;AACrBF,UAAAA,OAAO,CAACF,IAAR,CAAaI,CAAC,CAACH,IAAf;AACD,SAFD;AAGA,eAAOC,OAAO,CAACN,IAAR,CAAa,GAAb,CAAP;AACD,OAND;AAOA5C,MAAAA,CAAC,CAAC,SAAD,CAAD,CAAaU,EAAb,CAAgB,CAAhB,EAAmB2C,MAAnB,CAA0BrB,KAA1B;AACC,KA9CD;AA+CD;AAEF,CA9FA,CAAD","file":"script.75da7f30.map","sourceRoot":"..","sourcesContent":["$(function() {\n  let $tab = $('footer > .bt-tab')\n  let $section = $('main > section')\n  let mvNum = 0\n  let isLoading = false\n\n  $tab.on('click', function() {\n    let index = $(this).index()\n    $(this).addClass('fired').siblings().removeClass('fired')\n    $section.eq(index).addClass('fired').siblings().removeClass('fired')\n  })\n\n  requestData()\n  function requestData() {\n    if (isLoading) return\n    //数据已发出，未到达\n    isLoading = true\n    $.ajax({\n      url: 'https://api.douban.com/v2/movie/top250',\n      type: 'GET',\n      dataType: 'jsonp',\n      data: {\n        start: mvNum,\n        count: 20\n      }\n    }).done(function(data) {\n      console.log(data)\n      setData(data)\n    }).fail(function() {\n      console.log('err:' + err)\n    }).always(function() {\n      //数据到达后，重置为false\n      isLoading = false\n    })\n  }\n\n  $('main').on('scroll', function() {\n    if($('section').eq(0).height() - 10 <= $('main').scrollTop() + $('main').height()) {\n      requestData()\n    }\n  })\n\n  // 生成数据\n  function setData(data) {\n    mvNum += 20\n    data.subjects.forEach(ele => {\n      let template = `\n      <a href=\"#\">\n        <div class=\"cover\">\n          <img src=\"\" alt=\"\">\n        </div>\n        <div class=\"detail\">\n          <h2></h2>\n          <div class=\"extra\">\n            <span class=\"score\"></span>  / <span class=\"collect\"></span>收藏\n          </div>\n          <div class=\"extra\">\n             <span class=\"year\"> / <span class=\"genres\"></span> \n          </div>\n          <div class=\"extra\">\n            导演：<span class=\"director\"></span>\n          </div>\n          <div class=\"extra\">\n            主演：<span class=\"casting\"></span>\n          </div>\n        </div>\n      </a>\n    `\n    var $node = $(template)\n    $node.find('.cover img').attr(\"src\", ele.images.small)\n    $node.find('.detail h2').text(ele.title)\n    $node.find('.extra .score').text(ele.rating.average)\n    $node.find('.extra .collect').text(ele.collect_count)\n    $node.find('.extra .year').text(ele.year)\n    $node.find('.extra .genres').text(ele.genres.join(' / '))\n\n    $node.find('.extra .director').text(function() {\n      var director = []\n      ele.directors.forEach((j)=>{\n        director.push(j.name)\n      })\n      return director.join('、')\n    })\n    $node.find('.extra .casting').text(function() {\n      var casting = []\n      ele.casts.forEach((m)=>{\n        casting.push(m.name)\n      })\n      return casting.join('、')\n    })\n    $('section').eq(0).append($node)\n    })\n  }\n\n})"]}