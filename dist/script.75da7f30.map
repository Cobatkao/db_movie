{"version":3,"sources":["script.js"],"names":["paging","init","$tab","$","$panel","bind","_this","on","index","addClass","siblings","removeClass","eq","tpl","isToBottom","$Viewport","$Content","height","scrollTop","insertTpl","ele","$node","find","attr","alt","images","small","text","title","rating","average","collect_count","year","genres","join","directors","map","i","name","casts","m","top250Page","$element","$content","isLoading","isFinished","page","count","getData","data","render","clock","clearTimeout","setTimeout","console","log","total","callback","ajax","url","type","dataType","start","done","ret","fail","err","subjects","forEach","item","append","usBoardPage","subject","search","$container","$Result","$input","e","keyCode","keyword","val","q","app"],"mappings":"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","file":"script.75da7f30.map","sourceRoot":"..","sourcesContent":["const paging = {\n  init: function () {\n    this.$tab = $('footer > .bt-tab')\n    this.$panel = $('main > section')\n    this.bind()\n  },\n\n  bind: function () {\n    var _this = this //or arrow function\n    this.$tab.on('click', function () {\n      var index = $(this).index()\n      $(this).addClass('fired').siblings().removeClass('fired')\n      _this.$panel.eq(index).addClass('fired').siblings().removeClass('fired')\n    })\n  }\n}\n\n//模板\n const tpl = {\n  isToBottom: function($Viewport, $Content) {\n    return $Viewport.height() + $Viewport.scrollTop() + 30 > $Content.height()\n  },\n\n  insertTpl: function (ele) {\n    var $node = $(`\n      <div class=\"item\">\n        <a href=\"#\">\n          <div class=\"cover\">\n            <img src=\"\" alt=\"\">\n          </div>\n          <div class=\"detail\">\n            <h2></h2>\n            <div class=\"extra\">\n              <span class=\"score\"></span>  / <span class=\"collect\"></span>收藏\n            </div>\n            <div class=\"extra\">\n              <span class=\"year\"> / <span class=\"genres\"></span> \n            </div>\n            <div class=\"extra\">\n              <span class=\"director\"></span>\n            </div>\n            <div class=\"extra\">\n              <span class=\"casting\"></span>\n            </div>\n          </div>\n        </a>\n      </div>\n    `)\n    $node.find('a').attr('href', ele.alt)\n    $node.find('.cover img').attr(\"src\", ele.images.small)\n    $node.find('.detail h2').text(ele.title)\n    $node.find('.extra .score').text(ele.rating.average)\n    $node.find('.extra .collect').text(ele.collect_count)\n    $node.find('.extra .year').text(ele.year)\n    $node.find('.extra .genres').text(ele.genres.join(' / '))\n    $node.find('.extra .director').text(`导演：${ele.directors.map(i=>i.name).join('、')}`)\n    $node.find('.extra .casting').text(`演员：${ele.casts.map(m=>m.name).join('、')}`)\n\n    return $node\n  }\n}\n\n//top250页面\nconst top250Page = {\n  init: function () {\n    var _this = this\n    this.$element = $('#top-250')\n    this.$content = this.$element.find('.container')\n    //是否数据正在加载\n    this.isLoading = false\n    //是否载入完所有数据\n    this.isFinished = false\n    this.page = 0\n    this.count = 20\n    this.bind()\n    //data参数即数据到达后的ret\n    this.getData(function (data) {\n      _this.render(data)\n      _this.page++\n    })\n  },\n\n  bind: function () {\n    var _this = this\n    if(_this.clock) {\n      clearTimeout(_this.clock)\n    }\n    _this.clock = setTimeout(function() {\n      _this.$element.on('scroll', function () {\n        console.log(_this.isLoading)\n        //每次滚动判断 0.是否滚动到最底部 1.数据没有加载完 2.数据是否正在加载\n        if (tpl.isToBottom(_this.$element, _this.$content) && !_this.isLoading && !_this.isFinished) {\n          console.log('reach bottom and ready to send data!')\n          _this.getData(function (data) {\n            _this.render(data)\n            _this.page++\n            if (_this.count * _this.page >= data.total) {\n              _this.isFinished = true\n            }\n          })\n        }\n      })\n    }, 300)\n  },\n\n  getData: function (callback) {\n    var _this = this\n    _this.isLoading = true\n\n    console.log(_this.page)\n    console.log(_this.count)\n\n    //数据已发出，未到达\n    _this.$element.find('.loader').addClass('fired')\n    $.ajax({\n      url: 'https://douban.uieee.com/v2/movie/top250',\n      type: 'GET',\n      dataType: 'jsonp',\n      data: {\n        start: this.count * this.page,\n        count: this.count //20\n      }\n    }).done(function (ret) {\n      console.log(ret)\n      //数据已到达\n      _this.isLoading = false\n      _this.$element.find('.loader').removeClass('fired')\n      //执行回调\n      callback(ret)\n    }).fail(function (err) {\n      console.log('数据异常:' + err)\n    })\n  },\n\n  render: function (data) {\n    var _this = this\n    data.subjects.forEach(function (item) {\n      var $node = tpl.insertTpl(item)\n      _this.$content.append($node)\n    })\n  }\n}\n\nconst usBoardPage = {\n  init: function() {\n    var _this = this\n    this.$element = $('#beimei')\n    this.$content = this.$element.find('.container')\n    this.getData(function(data){\n      _this.render(data)\n    })\n  },\n\n  getData: function(callback) {\n    $.ajax({\n      url : 'https://douban.uieee.com/v2/movie/us_box',\n      data : {\n          start : 0,\n          count : 10\n      },\n      dataType : 'jsonp'\n    }).done(function(ret){\n      console.log(ret)\n      callback(ret)\n    })\n  },\n\n  render: function(data) {\n    var _this = this\n    data.subjects.forEach(function(item){\n        var $node = tpl.insertTpl(item.subject)\n        _this.$content.append($node)\n    })\n  }\n}\n\nconst search = {\n  init: function() {\n    var _this = this\n    this.$container = $('#Search')\n    this.$content = this.$container.find('.search-result .container')\n    this.page = 0\n    this.count = 10\n    this.isLoading = false\n    this.isFinished = false\n    this.isToBottom = function($Viewport, $Result, $input) {\n      return $Viewport.height() + $Viewport.scrollTop() + 30 > $Result.height() + $input.height()\n    },\n    this.bind()\n    this.getData(function (data) {\n      _this.render(data)\n      _this.page++\n    })\n  },\n\n  bind: function() {\n    var _this = this\n    this.$container.find('.search-area .button').on('click', function() {\n      console.log('click!')\n      _this.getData(function(data) {\n        _this.render(data)\n      })\n    })\n    this.$container.find('.search-area input').on('keyup', function(e) {\n      if(e.keyCode === 13) {\n        _this.getData(function(data) {\n          _this.render(data)\n        })\n      }\n    })\n\n    if(_this.clock) {\n      clearTimeout(_this.clock)\n    }\n\n    _this.clock = setTimeout(function() {\n      _this.$container.on('scroll', function () {\n        console.log(_this.isLoading)\n        //每次滚动判断 0.是否滚动到最底部 1.数据没有加载完 2.数据是否正在加载\n        if (_this.isToBottom(_this.$container, _this.$container.find('.search-result'), _this.$container.find('.search-area')) && !_this.isLoading && !_this.isFinished) {\n          console.log('reach bottom and ready to send data!')\n          _this.getData(function (data) {\n            _this.render(data)\n            _this.page++\n            if (_this.count * _this.page >= data.total) {\n              _this.isFinished = true\n            }\n          })\n        }\n      })\n    }, 300)\n  },\n        \n  getData: function(callback) {\n    var _this = this\n    _this.$container.find('.loader').addClass('fired')\n    var keyword = this.$container.find('.search-area input').val()\n    this.isLoading = true\n    $.ajax({\n      url: 'https://douban.uieee.com/v2/movie/search',\n      data: {\n        q: keyword,\n        start: this.count * this.page,\n        count: this.count\n      },\n      dataType: 'jsonp'\n    }).done(function(ret) {\n      _this.isLoading = false\n      _this.$container.find('.loader').removeClass('fired')\n      callback(ret)\n    })\n  },\n\n  render: function(data) {\n    var _this = this\n    data.subjects.forEach(function (item) {\n      var $node = tpl.insertTpl(item)\n      _this.$content.append($node)\n    })\n  }\n}\n\nconst app = {\n  init: function () {\n    //初始化页面\n    paging.init()\n    top250Page.init()\n    usBoardPage.init()\n    search.init()\n  }\n}\n//初始化\napp.init()"]}